(-> (unify (from :lineitem [l-shipdate l-quantity l-extendedprice l-discount]) (where (>= l-shipdate #time/date "1994-01-01") (< l-shipdate #time/date "1995-01-01") (>= l-discount 0.05) (<= l-discount 0.07) (< l-quantity 24.0))) (aggregate {:revenue (sum (* l-extendedprice l-discount))}))